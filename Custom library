local library = {}

local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

local gui = Instance.new("ScreenGui", CoreGui)
gui.Name = "CustomUILib"
gui.ResetOnSpawn = false

-- Drag Function
local function dragify(frame)
	local dragging, offset
	frame.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			offset = input.Position - frame.Position
		end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
			frame.Position = UDim2.new(0, input.Position.X - offset.X, 0, input.Position.Y - offset.Y)
		end
	end)
	UserInputService.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = false
		end
	end)
end

function library:CreateWindow(titleText)
	local main = Instance.new("Frame", gui)
	main.Size = UDim2.new(0, 400, 0, 300)
	main.Position = UDim2.new(0.5, -200, 0.5, -150)
	main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	main.BorderSizePixel = 0

	local title = Instance.new("TextLabel", main)
	title.Size = UDim2.new(1, -40, 0, 30)
	title.Position = UDim2.new(0, 10, 0, 10)
	title.Text = titleText or "UI Library"
	title.Font = Enum.Font.SourceSansBold
	title.TextSize = 24
	title.TextColor3 = Color3.new(1, 1, 1)
	title.BackgroundTransparency = 1
	title.TextXAlignment = Enum.TextXAlignment.Left

	local close = Instance.new("TextButton", main)
	close.Text = "X"
	close.Size = UDim2.new(0, 30, 0, 30)
	close.Position = UDim2.new(1, -35, 0, 10)
	close.BackgroundTransparency = 1
	close.TextColor3 = Color3.new(1, 1, 1)
	close.Font = Enum.Font.SourceSansBold
	close.TextSize = 22
	close.MouseButton1Click:Connect(function()
		gui:Destroy()
	end)

	dragify(main)

	local tabButtons = {}
	local currentTab = nil
	local tabYOffset = 50

	return {
		AddTab = function(_, tabName)
			local tabBtn = Instance.new("TextButton", main)
			tabBtn.Size = UDim2.new(0, 100, 0, 30)
			tabBtn.Position = UDim2.new(0, 10, 0, tabYOffset)
			tabBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
			tabBtn.Text = tabName
			tabBtn.TextColor3 = Color3.new(1, 1, 1)
			tabBtn.Font = Enum.Font.SourceSansBold
			tabBtn.TextSize = 20

			tabYOffset += 35

			local tabFrame = Instance.new("Frame", main)
			tabFrame.Size = UDim2.new(1, -120, 1, -60)
			tabFrame.Position = UDim2.new(0, 110, 0, 50)
			tabFrame.BackgroundTransparency = 1
			tabFrame.Visible = false

			local sectionYOffset = 0

			tabBtn.MouseButton1Click:Connect(function()
				if currentTab then
					currentTab.Visible = false
				end
				tabFrame.Visible = true
				currentTab = tabFrame
			end)

			if not currentTab then
				currentTab = tabFrame
				tabFrame.Visible = true
			end

			return {
				AddSection = function(_, sectionName)
					local sectionLabel = Instance.new("TextLabel", tabFrame)
					sectionLabel.Size = UDim2.new(1, 0, 0, 30)
					sectionLabel.Position = UDim2.new(0, 0, 0, sectionYOffset)
					sectionLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
					sectionLabel.Text = sectionName
					sectionLabel.TextColor3 = Color3.new(1, 1, 1)
					sectionLabel.Font = Enum.Font.SourceSansBold
					sectionLabel.TextSize = 20
					sectionYOffset += 35

					local buttonYOffset = sectionYOffset

					return {
						AddButton = function(_, text, callback)
							local button = Instance.new("TextButton", tabFrame)
							button.Size = UDim2.new(1, 0, 0, 30)
							button.Position = UDim2.new(0, 0, 0, buttonYOffset)
							button.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
							button.Text = text
							button.TextColor3 = Color3.new(1, 1, 1)
							button.Font = Enum.Font.SourceSansBold
							button.TextSize = 18
							button.MouseButton1Click:Connect(callback)
							buttonYOffset += 35
							sectionYOffset = buttonYOffset
						end
					}
				end
			}
		end
	}
end

return library
